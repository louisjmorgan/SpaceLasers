(()=>{"use strict";var e,t,r={12618:(e,t,r)=>{r.d(t,{$D:()=>u,gw:()=>c,lu:()=>m});var n=r(63310),o=r(42003),a=(r(31575),r(80949),r(55287)),i=r(434);(0,n.e)({});const s=o.Ry().shape({name:o.Z_().min(2,"Too Short!").max(50,"Too Long!").trim(),color:o.Z_().trim().matches(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i),orbit:o.Ry().shape({tle:o.Z_(),list:o.Z_(),meanMotionDot:o.Rx().min(-1,"Must be more than -1").max(1,"Must be less than 1").required("meanMotionDot is required"),bstar:o.Rx().min(-2,"Must be between -2 and 2").max(2,"Must be between -2 and 2").required("bstar is required"),inclination:o.Rx().min(0,"Must be 0-360°").max(360,"Must be 0-360°").required("inclination is required"),rightAscension:o.Rx().min(0,"Must be 0-360°").max(360,"Must be 0-360°").required("right ascension is required"),eccentricity:o.Rx().min(0,"Must be between 0 and 1").max(1,"Must be between 0 and 1").required("eccentricity is required"),perigee:o.Rx().min(0,"Must be 0-360°").max(360,"Must be 0-360°").required("perigee is required"),meanAnomaly:o.Rx().min(0,"Must be 0-360°").max(360,"Must be 0-360°").required("mean anomaly is required"),meanMotion:o.Rx().min(0,"Must be greater than 0").max(16,"Must be less than 16").required("mean motion is required")}),power:o.Ry().shape({pv:o.Ry().shape({voltage:o.Rx().min(0,"Must be positive").required("pv voltage is required"),currentDensity:o.Rx().min(0,"Must be positive").required("pv current density is required"),area:o.Rx().min(0,"Must be greater than 0").required("pv area is required"),powerStoringConsumption:o.Rx().min(0,"Must be greater than 0").required("Power storing consumption is required"),preset:o.Z_().oneOf(["small","medium","large","custom"])}),battery:o.Ry().shape({voltage:o.Rx().min(0,"Must be positive").required("battery voltage is required"),capacity:o.Rx().min(0,"Must be greater than 0").required("battery capacity is required"),preset:o.Z_().oneOf(["small","medium","large","custom"])})}),duties:o.IX().of(o.Ry().shape({type:o.Z_().oneOf(["cyclical"]).required("Type is required"),name:o.Z_().min(2,"Too Short!").max(30,"Too Long!").required("required!"),priority:o.Rx().integer().min(1).required("Priority is required"),consumption:o.Rx().min(0,"Must be positive").required("Consumption is required"),duration:o.Rx().min(0,"Must be positive").when("type",{is:"cyclical",then:o.Rx().required("Duration is required")}),cycles:o.Rx().min(0,"Must be positive").when("type",{is:"cyclical",then:o.Rx().required("Cycles is required")})}))}),c=(o.Ry().shape({constellations:o.IX().of(o.Ry().shape({name:o.Z_().min(2,"Too Short!").max(50,"Too Long!").trim(),list:o.Z_(),payload:s,satelliteCount:o.Rx().min(0).required("Satellite count is required"),satellites:o.IX().of(s),spacePowersCount:o.Rx().integer().min(0,"Must be an integer greater than or equal to 0"),spacePowerIndices:o.IX().of(o.Rx().min(0)),offsets:o.Ry().shape({inclination:o.Rx().min(0,"Must be 0-36°").max(36,"Must be 0-36°").required("inclination is required"),rightAscension:o.Rx().min(0,"Must be 0-36°").max(36,"Must be 0-36°").required("right ascension is required"),eccentricity:o.Rx().min(0,"Must be between 0 and 1").max(1,"Must be between 0 and 1").required("eccentricity is required"),perigee:o.Rx().min(0,"Must be 0-36°").max(36,"Must be 0-36°").required("perigee is required"),meanAnomaly:o.Rx().min(0,"Must be 0-360°").max(360,"Must be 0-360°").required("mean anomaly is required"),meanMotion:o.Rx().min(0,"Must be greater than 0").max(16,"Must be less than 16").required("mean motion is required")})}))}),(e,t,r,n)=>{const o=(e=>{const t=[];return e.forEach((e=>{let r;r=e.spacePowerIndices?e.spacePowerIndices:(0,a.X_)(e.spacePowersCount,e.satellites.length);const n=(0,a.mA)(e.satellites.length,r),o=(0,a.rl)(e.offsets,n);e.satellites.forEach(((r,n)=>{if(o[n])return o[n].forEach((o=>{t.push((0,a.Iq)(`Space Power ${n+1}`,r.orbit,o,e))}))}))})),t})(r),s=[];return o.forEach((r=>{r.positions=(0,i.VG)(r.params,e);const o=(0,i.x2)(r,n.filter((e=>e.constellation===r.constellation)),e);r.performance={currentDuties:(0,i.O0)(o,e),isEclipsed:(0,i.HE)(r,t,e)},r.performance.sources=(0,i.e6)(r,o,e),r.performance.chargeState=(0,i.Kg)(r,e),s.push(...o)})),[o,s]}),u=(e,t,r)=>{e.forEach((e=>{e.performance.sources=(0,i.e6)(e,r,t),e.performance={...e.performance,chargeState:(0,i.Kg)(e,t),chargeStateNoBeams:(0,i.Kg)(e,t,!1)};const[n,o,a]=(0,i.rR)(e),[s,c]=(0,i.mV)(e);e.summary={totalDischarge:n,dischargeSaved:o,timeCharged:a,lowestChargeStateBeams:s,lowestChargeStateNoBeams:c}}))},m=(e,t,r,n)=>t.map((t=>{const o=t.satellites.map((e=>r.find((t=>t.id===e))));return{...t,isCustomer:!0,spacePowers:n.filter((e=>e.constellation===t.id)).map((e=>e.id)),performance:{chargeState:e.map(((e,t)=>o.reduce(((e,r)=>e+r.performance.chargeState[t]),0)/r.length)),chargeStateNoBeams:e.map(((e,t)=>o.reduce(((e,r)=>e+r.performance.chargeStateNoBeams[t]),0)/r.length))},summary:{dischargeSaved:o.reduce(((e,t)=>e+t.summary.dischargeSaved),0),timeCharged:o.reduce(((e,t)=>e+t.summary.timeCharged),0),lowestChargeStateBeams:o.reduce(((e,t)=>{const r=t.summary.lowestChargeStateBeams;return e<r?e:r}),o[0].summary.lowestChargeStateBeams),lowestChargeStateNoBeams:o.reduce(((e,t)=>{const r=t.summary.lowestChargeStateNoBeams;return e<r?e:r}),o[0].summary.lowestChargeStateNoBeams)}}}))},55287:(e,t,r)=>{r.d(t,{Iq:()=>m,X_:()=>l,mA:()=>p,rl:()=>d});var n=r(63310),o=r(72045),a=r(31575),i=r(80949);(0,n.e)({});const s={sunOnly:{name:"sun",efficiency:1},beamOnly:{name:"beam",efficiency:1},sunAndBeam:{name:"sun and beam",efficiency:1.5},eclipsed:{name:"eclipsed",efficiency:0}},c={power:{pv:{voltage:4.7,currentDensity:170.5,area:.0128,powerStoringConsumption:1.2},battery:{voltage:3.6,capacity:1.125}},duties:[{name:"beaming",duration:null,cycles:null,consumption:3.2,type:"space power"}]};function u(e,t,r){const n=Number(e.cycles),o=1e3*Number(e.duration),a=(t-o*n)/n,s=Math.floor(i.FT/t*n);return Array.from({length:s},((e,t)=>{const n=r.valueOf()+a*(t+1)+o*t;return{start:n,end:n+o}}))}function m(e,t,r,n){const i={...t};return Object.entries(r).forEach((e=>{i[e[0]]=t[e[0]]+Number(e[1])})),function(e,t,r=!0){const n=(0,a.nf)({...e.orbit,epoch:new Date(e.orbit.epoch)}),o=(0,a.YX)(n.tle1,n.tle2);try{(0,a.ku)({orbit:o},new Date)}catch(t){const n=`Unable to propagate orbital parameters for ${e.orbit.tle}. ${r?"\nPlease try different values or choose a TLE.":"\nPlease try different offsets in the power configuration menu."}`;throw new Error(n)}o.period=2*Math.PI*60*1e3/o.no;const i={sources:s,voltage:e.power.pv.voltage,currentDensity:e.power.pv.currentDensity,area:e.power.pv.area},c={voltage:e.power.battery.voltage,capacity:e.power.battery.capacity},m=e.duties.map((e=>({name:e.name,type:e.type,priority:e.priority,consumption:Number(e.consumption),duration:1e3*Number(e.duration)||null,cycles:Number(e.cycles)||null,intervals:"cyclical"===e.type?u(e,o.period,o.epochdate):null})));m.unshift({name:"Power storing",type:"power storing",consumption:e.power.pv.powerStoringConsumption});const l=function(e,t,r){const{area:n,voltage:o,currentDensity:a}=e,i=[];return Object.entries(e.sources).forEach((e=>{const s=a*e[1].efficiency*n*o,c=[];t.forEach((e=>{const t=(s-e.consumption)/r.voltage;c.push(t)})),i[e[1].name]=c})),i}(i,m,c);return{name:e.name,color:e.color,constellation:t,id:e.id,params:{orbit:o,battery:c,pv:i,load:{powerProfiles:l,duties:m}},isCustomer:r}}({...c,name:e,color:n.spacePowerColor,id:(0,o.Z)(),orbit:i},n.id,!1)}function l(e,t){const r=t/e;return Array.from({length:e},((e,t)=>Math.floor(r*t)))}function p(e,t){return Array.from({length:e},((e,r)=>t.filter((e=>e===r)).length))}function d(e,t){return t.map((t=>{if(0===t)return null;if(1===t)return[e];if(t>1){let r=0;return Array.from({length:t},((t,n)=>{n%2==0&&(r+=1);const o={};return Object.entries(e).forEach((e=>{o[e[0]]=e[1]*r*(-1)**n})),o}))}}))}},434:(e,t,r)=>{r.d(t,{HE:()=>m,Kg:()=>g,O0:()=>p,VG:()=>u,e6:()=>d,mV:()=>b,rR:()=>h,x2:()=>l});var n=r(63310),o=r(72045),a=r(76150),i=r(31575),s=r(40549),c=r(80949);function u(e,t){const r=[],n=[],o=[];return t.forEach((t=>{const a=(0,i.ku)(e,new Date(t));r.push(a.x),n.push(a.y),o.push(a.z)})),{x:r,y:n,z:o}}function m(e,t,r){return r.map(((r,n)=>{const o={x:e.positions.x[n],y:e.positions.y[n],z:e.positions.z[n]},a={x:t.x[n],y:t.y[n],z:t.z[n]};return(0,s.Wb)(o,a)}))}function l(e,t,r){return t.map((t=>{const n=`${e.name} - ${t.name}`,s=r.map(((r,n)=>{const o={x:e.positions.x[n],y:e.positions.y[n],z:e.positions.z[n]},a={x:t.positions.x[n],y:t.positions.y[n],z:t.positions.z[n]};return(0,i.Sp)(o,a)})),u=s.map((e=>e*a.earthRadius<c.R1));return{name:n,distances:s,activated:u,customerId:t.id,spacePowerId:e.id,id:(0,o.Z)()}}))}function p(e,t){return t.map(((t,r)=>e.reduce(((e,t)=>t.activated[r]||e),!1)?1:0))}function d(e,t,r){return r.map(((r,n)=>function(e,t,r){let n;n=!!t&&t.filter((t=>t.customerId===e.id)).reduce(((e,t)=>t.activated[r]||e),!1);const o=!e.performance.isEclipsed[r];return!o&&n?"beam":o&&n?"sun and beam":o||n?o&&!n?"sun":void 0:"eclipsed"}(e,t,n)))}function g(e,t,r=!0){const n=c.FT/36e5/t.length;let o=1;return t.map(((t,a)=>{let i=e.performance.sources[a];return!1===r&&("sun and beam"===i&&(i="sun"),"beam"===i&&(i="eclipsed")),o=(0,s._u)(e.params,e.performance.currentDuties[a],i,o,n),o>1?1:o<0?0:o}))}function h(e){let t=0;const r=e.performance.sources.reduce(((t,r,n)=>{const o=e.performance.currentDuties[n];return(0,s.TZ)(e.params,r,o)+t}),0),n=e.performance.sources.reduce(((t,r,n)=>{const o=e.performance.currentDuties[n],a=(0,s.TZ)(e.params,r,o);return a<0?a+t:t}),0),o=e.performance.sources.reduce(((r,n,o)=>{const a=e.performance.currentDuties[o];let i=n;return"sun and beam"===n?(i="sun",t+=1):"beam"===n&&(t+=1,i="eclipsed"),(0,s.TZ)(e.params,i,a)+r}),0),a=e.performance.sources.length,i=c.FT/36e5/a,u=Math.abs(n*i),m=(r-o)*i;return t=t/a*c.FT/6e4,[u,m,t]}function b(e){return[e.performance.chargeState.reduce(((e,t)=>t<e?t:e),1),e.performance.chargeStateNoBeams.reduce(((e,t)=>t<e?t:e),1)]}(0,n.e)({})},35582:(e,t,r)=>{var n=r(63310),o=r(79103),a=r(12618);let i;(0,n.e)({});const s={initialize:e=>(i=e,!0),calculate:e=>new Promise((t=>{try{const[r,n]=(0,a.gw)(i.time,i.sun,e.constellations,i.satellites.customers);(0,a.$D)(i.satellites.customers,i.time,n),t((0,a.lu)(i.time,i.constellations,i.satellites.customers,r)[0].summary.dischargeSaved)}catch(e){t(0)}}))};(0,o.Jj)(s)},31575:(e,t,r)=>{r.d(t,{Sp:()=>l,YX:()=>u,ku:()=>m,nf:()=>c});var n=r(63310),o=r(76150),a=r(95793),i=r(75931),s=r(72946);function c(e){const{epoch:t,meanMotionDot:r,bstar:n,inclination:o,rightAscension:a,eccentricity:i,perigee:s,meanAnomaly:c,meanMotion:u}=e;let m=String(t.getYear());m>100&&(m=m.substring(1));let l=(p=t,(Date.UTC(p.getFullYear(),p.getMonth(),p.getDate())-Date.UTC(p.getFullYear(),0,0))/24/60/60/1e3);var p;l<100&&(l=`0${l}`);const d=String((t.getHours()/24+t.getMinutes()/1440+t.getSeconds()/86400).toFixed(8)).substring(1);let g=String(Number(r).toFixed(8)).substring(1);r<0&&(g=`-${g.substring(1)}`),r>=0&&(g=` ${g}`);let h=String(Number(n).toExponential(5)).split(".").join("").substring(0,6);n>=0&&(h=` ${h.substring(0,5)}`);let b=0;b=0!==Number(n)?Math.ceil(Math.log10(Math.abs(n))):"+0";const f=`1 00000C 00000A   ${m}${l}${d} ${g}  00000-0 ${h}${b} 0  0000`,y=String(Number(o).toFixed(4)),x=String(Number(a).toFixed(4)),w=String(Number(i).toFixed(8)).substring(2,9);let v=String(Number(s).toFixed(4));s<100&&(v=` ${v}`);const q=String(Number(c).toFixed(4)),M=String(Number(u).toPrecision(9));return{tle1:f,tle2:`2 00000 ${y.padStart(8)} ${x.padStart(8)} ${w} ${v.padStart(8)} ${q} ${M.padStart(13)}    00`}}function u(e,t){const r=1440/(2*o.pi);let n=0;const s={error:0};s.satnum=e.substring(2,7),s.epochyr=parseInt(e.substring(18,20),10),s.epochdays=parseFloat(e.substring(20,32)),s.ndot=parseFloat(e.substring(33,43)),s.nddot=parseFloat(`.${parseInt(e.substring(44,50),10)}E${e.substring(50,52)}`),s.bstar=parseFloat(`${e.substring(53,54)}.${parseInt(e.substring(54,59),10)}E${e.substring(59,61)}`),s.inclo=parseFloat(t.substring(8,16)),s.nodeo=parseFloat(t.substring(17,25)),s.ecco=parseFloat(`.${t.substring(26,33)}`),s.argpo=parseFloat(t.substring(34,42)),s.mo=parseFloat(t.substring(43,51)),s.no=parseFloat(t.substring(52,63)),s.notle=s.no,s.no/=r,s.a=(s.no*o.tumin)**(-2/3),s.ndottle=s.ndot,s.ndot/=1440*r,s.nddot/=1440*r*1440,s.inclotle=s.inclo,s.inclo*=o.deg2rad,s.nodeotle=s.nodeo,s.nodeo*=o.deg2rad,s.argpotle=s.argpo,s.argpo*=o.deg2rad,s.motle=s.mo,s.mo*=o.deg2rad,s.alta=s.a*(1+s.ecco)-1,s.altp=s.a*(1-s.ecco)-1,n=s.epochyr<57?s.epochyr+2e3:s.epochyr+1900;const c=(0,a.days2mdhms)(n,s.epochdays),{mon:u,day:m,hr:l,minute:p,sec:d}=c;return s.jdsatepoch=(0,a.jday)(n,u,m,l,p,d),s.epochdate=new Date(n,u,m,l,p,d),s.epochdatetimelocal=new Date(s.epochdate.getTime()-6e4*s.epochdate.getTimezoneOffset()).toISOString().substring(0,19),(0,i.Z)(s,{opsmode:"i",satn:s.satnum,epoch:s.jdsatepoch-2433281.5,xbstar:s.bstar,xecco:s.ecco,xargpo:s.argpo,xinclo:s.inclo,xmo:s.mo,xno:s.no,xnodeo:s.nodeo}),s}function m(e,t){const r=function(e,t){return{x:(r=s.a0(e.orbit,t).position).x/o.earthRadius,y:r.z/o.earthRadius,z:-r.y/o.earthRadius};var r}(e,t);return{x:r.x,y:r.y,z:r.z}}function l(e,t){const r=e.x-t.x,n=e.y-t.y,o=e.z-t.z;return Math.sqrt(r*r+n*n+o*o)}(0,n.e)({})},80949:(e,t,r)=>{r.d(t,{FT:()=>n,R1:()=>o}),(0,r(63310).e)({});const n=1728e5,o=1e3},40549:(e,t,r)=>{r.d(t,{TZ:()=>p,Wb:()=>l,_u:()=>d});var n=r(63310),o=r(76150),a=r(99477);(0,n.e)({});const i=new a.Vector3(0,0,0),s=new a.Vector3,c=new a.Vector3,u=new a.Vector3,m=new a.Vector3;function l(e,t){s.fromArray([t.x,t.y,t.z]),c.fromArray([e.x,e.y,e.z]),u.subVectors(i,s),m.subVectors(c,i);const r=u.angleTo(m),n=s.distanceTo(i),a=s.distanceTo(c);return!(r>Math.atan2(o.earthRadius,n)||a<n)}function p(e,t,r){return e.load.powerProfiles[t][r]}function d(e,t,r,n,o){const a=p(e,r,t),{capacity:i}=e.battery;return n>=1&&a>=0?1:n<=0&&a<=0?0:(n*i+o*a)/i}}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return r[e].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}o.m=r,o.x=()=>{var e=o.O(void 0,[546,752,119],(()=>o(35582)));return o.O(e)},e=[],o.O=(t,r,n,a)=>{if(!r){var i=1/0;for(m=0;m<e.length;m++){for(var[r,n,a]=e[m],s=!0,c=0;c<r.length;c++)(!1&a||i>=a)&&Object.keys(o.O).every((e=>o.O[e](r[c])))?r.splice(c--,1):(s=!1,a<i&&(i=a));if(s){e.splice(m--,1);var u=n();void 0!==u&&(t=u)}}return t}a=a||0;for(var m=e.length;m>0&&e[m-1][2]>a;m--)e[m]=e[m-1];e[m]=[r,n,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,r)=>(o.f[r](e,t),t)),[])),o.u=e=>e+".bundle.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={582:1};o.f.i=(t,r)=>{e[t]||importScripts(o.p+o.u(t))};var t=self.webpackChunk=self.webpackChunk||[],r=t.push.bind(t);t.push=t=>{var[n,a,i]=t;for(var s in a)o.o(a,s)&&(o.m[s]=a[s]);for(i&&i(o);n.length;)e[n.pop()]=1;r(t)}})(),t=o.x,o.x=()=>Promise.all([546,752,119].map(o.e,o)).then(t),o.x()})();
//# sourceMappingURL=582.bundle.js.map